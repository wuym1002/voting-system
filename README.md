# 汇报评分投票系统

基于Flask + MySQL的汇报评分投票系统，专为PC架构委员会设计。

## 功能特性

- 📝 **创建汇报投票**：管理员可以创建新的汇报投票项目
- 🗳️ **评委投票**：评委可以对汇报进行评分（-3到+3分）和评价
- 📊 **实时统计**：自动计算平均分和最终得分（基础分5分+平均评分）
- 🔒 **投票控制**：支持关闭投票，防止重复投票
- 📱 **响应式设计**：支持手机、平板、电脑访问

## 评分规则

- **基础分**：5分（固定）
- **评委评分**：-3分到+3分
- **最终得分**：基础分 + 各评委评分的平均加权值
- **投票限制**：每个评委对同一汇报只能投票一次

## 技术栈

- **后端**：Python Flask
- **数据库**：MySQL 8.0+
- **前端**：Bootstrap 5 + HTML/CSS/JavaScript
- **部署**：支持本地部署

## 安装部署

### 1. 环境要求

- Python 3.8+
- MySQL 8.0+
- pip

### 2. 安装步骤

```bash
# 1. 克隆代码
git clone <repository-url>
cd voting-system

# 2. 安装依赖
pip install -r requirements.txt

# 3. 配置数据库
# 修改 app.py 中的数据库配置
DB_CONFIG = {
    'host': 'localhost',
    'database': 'voting_system',
    'user': 'root',
    'password': 'your_password',  # 修改为您的MySQL密码
    'charset': 'utf8mb4',
    'use_unicode': True,
    'autocommit': True
}

# 4. 初始化数据库
# 系统启动时会自动执行 database_schema.sql 创建数据库和表

# 5. 启动应用
python app.py
```

### 3. 访问系统

打开浏览器访问：`http://localhost:5000`

## 使用说明

### 管理员操作

1. **创建投票**
   - 点击"创建投票"按钮
   - 填写汇报标题、内容描述、创建者姓名
   - 可选设置投票截止时间

2. **管理投票**
   - 查看投票详情和统计结果
   - 关闭投票（关闭后无法继续投票）

### 评委操作

1. **参与投票**
   - 选择要投票的汇报项目
   - 输入评委姓名
   - 选择评分（-3到+3分）
   - 填写评价意见（可选）
   - 提交投票

2. **查看结果**
   - 查看所有评委的投票详情
   - 查看实时统计结果

## 数据库结构

### reports 表（汇报项目）
- `id`: 主键
- `title`: 汇报标题
- `description`: 汇报描述
- `creator`: 创建者
- `created_at`: 创建时间
- `status`: 状态（active/closed）
- `deadline`: 截止时间

### judges 表（评委）
- `id`: 主键
- `name`: 评委姓名
- `email`: 邮箱

### votes 表（投票记录）
- `id`: 主键
- `report_id`: 汇报项目ID
- `judge_name`: 评委姓名
- `score`: 评分（-3到3）
- `comment`: 评价意见
- `created_at`: 投票时间

## API接口

- `GET /`: 首页，显示所有汇报项目
- `GET/POST /create`: 创建新投票
- `GET /report/<id>`: 查看汇报详情
- `GET/POST /vote/<id>`: 投票页面
- `POST /api/reports/<id>/close`: 关闭投票
- `GET /api/reports/<id>/results`: 获取投票结果

## 安全特性

- 防止重复投票（同一评委对同一汇报只能投票一次）
- 输入验证和SQL注入防护
- 评分范围限制（-3到+3）
- 投票状态控制

## 自定义配置

可以根据需要修改以下配置：

1. **数据库配置**：修改 `app.py` 中的 `DB_CONFIG`
2. **评分范围**：目前固定为-3到+3，可在代码中调整
3. **基础分**：目前固定为5分，可在代码中调整
4. **界面样式**：修改模板文件中的CSS样式

## 故障排除

1. **数据库连接失败**
   - 检查MySQL服务是否启动
   - 确认数据库配置信息正确
   - 确保MySQL用户有足够权限

2. **页面无法访问**
   - 检查Flask应用是否正常启动
   - 确认端口5000未被占用
   - 检查防火墙设置

3. **投票失败**
   - 检查评分是否在有效范围内
   - 确认评委姓名已填写
   - 检查是否已经投过票

## 联系支持

如有问题或建议，请联系系统管理员。